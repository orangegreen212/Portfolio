<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Портфолио: Метод SARIMA</title>
    <link rel="stylesheet" href="../styles.css"> <!-- Ссылка на файл стилей на уровень выше -->
</head>
<body>
    <div class="container">
        <nav>
            <a href="../index.html">На главную</a>
            <a href="../prophet/prophet.html">К Prophet</a>
            <a href="../xgboost/xgboost.html">К XGBoost</a>
        </nav>

        <h1>Метод SARIMA</h1>

        <p>
            SARIMA (Seasonal Autoregressive Integrated Moving Average) — это классическая статистическая модель,
            расширяющая модель ARIMA для учета сезонности во временных рядах. Она хорошо подходит для данных с
            четко выраженными сезонными паттернами. Модель задается параметрами (p, d, q)(P, D, Q, S),
            где (p, d, q) относятся к нестационарной части, а (P, D, Q, S) — к сезонной.
        </p>

        <h2>Используемые данные</h2>
        <p>
            Для демонстрации метода SARIMA использованы данные по [Краткое описание ваших данных, например, "ежедневным продажам"].
            Данные охватывают период с [Дата начала] по [Дата окончания].
        </p>
        <!-- Можно вставить небольшой график исходных данных, если он сохранен -->
        <!-- <img src="../images/raw_data_plot.png" alt="График исходных данных"> -->


        <h2>Реализация на Python</h2>
        <p>
            Ниже представлены ключевые фрагменты кода, использованные для обучения и прогнозирования с помощью SARIMA.
            Для определения оптимальных параметров (p, d, q)(P, D, Q, S) может использоваться анализ ACF/PACF
            или алгоритмы автоматического подбора (например, <code>auto_arima</code>).
        </p>

        <h3>Загрузка и подготовка данных:</h3>
        <pre><code class="language-python">
import pandas as pd
import matplotlib.pyplot as plt
from statsmodels.tsa.statespace.sarimax import SARIMAX
from sklearn.metrics import mean_squared_error, mean_absolute_error
import numpy as np

# Загрузка данных (путь относительно места запуска скрипта)
data = pd.read_csv('../data/your_data.csv')
data['Date'] = pd.to_datetime(data['Date'])
data.set_index('Date', inplace=True)
ts = data['Value'] # Целевая переменная

# Разделение на тренировочную и тестовую выборки
train_size = int(len(ts) * 0.8)
train_data, test_data = ts[0:train_size], ts[train_size:]
        </code></pre>

        <h3>Обучение модели и прогнозирование:</h3>
         <pre><code class="language-python">
# Определение параметров (пример)
order = (1, 1, 1)
seasonal_order = (1, 1, 1, 12) # S=12 для месячной сезонности

# Инициализация и обучение модели
model = SARIMAX(train_data,
                order=order,
                seasonal_order=seasonal_order,
                enforce_stationarity=False,
                enforce_invertibility=False)

results = model.fit(disp=False)

# Прогнозирование на тестовой выборке
start_index = len(train_data)
end_index = len(ts) - 1
predictions = results.predict(start=start_index, end=end_index, dynamic=False)

# Прогноз на будущее (например, 30 шагов)
future_steps = 30
forecast = results.forecast(steps=future_steps)
        </code></pre>

        <h2>Результаты прогнозирования</h2>
        <p>
            После обучения модели SARIMA были получены следующие результаты на тестовой выборке:
        </p>

        <h3>График фактических vs. прогнозов на тестовой выборке:</h3>
        <!-- Убедитесь, что имя файла совпадает с тем, что сохраняется в sarima_code.py -->
        <img src="../images/sarima_actual_vs_predicted.png" alt="SARIMA фактические vs прогнозы">

        <h3>Прогноз на будущее:</h3>
        <!-- Убедитесь, что имя файла совпадает с тем, что сохраняется в sarima_code.py -->
        <img src="../images/sarima_future_forecast.png" alt="SARIMA прогноз на будущее">


        <h2>Метрики качества</h2>
        <p>
            Оценка точности модели на тестовой выборке по следующим метрикам:
        </p>
        <div class="metrics">
            <p><strong>RMSE:</strong> [Вставьте значение RMSE, полученное из скрипта, например 55.23]</p>
            <p><strong>MAE:</strong> [Вставьте значение MAE, например 40.15]</p>
            <!-- Добавьте другие метрики при необходимости -->
        </div>

        <h2>Выводы по SARIMA</h2>
        <p>
            [Краткий вывод о том, как хорошо SARIMA справилась с вашими данными.
             Какие паттерны она уловила? Какие были ограничения или сложности?
             Например: "Модель SARIMA успешно уловила как общий тренд, так и выраженную годовую сезонность.
             Однако, были сложности с прогнозированием резких пиков..."].
        </p>

         <nav>
            <a href="../index.html">На главную</a>
            <a href="../prophet/prophet.html">К Prophet</a>
            <a href="../xgboost/xgboost.html">К XGBoost</a>
        </nav>

        <footer>
            <p>© 2023 Ваше Имя</p>
        </footer>
    </div>
</body>
</html>
